

[TOC]

# mysql 单表最大记录数是多少？过多怎么优化呢？

点点趣说 2019-08-07 06:03:00



## MySQL单表最大记录数是多少？

其实，MySQL本身并没有对单表最大记录数进行限制.但是从性能考虑，肯定是有一定影响的

曾经在中国互联网技术圈广为流传着这么一个说法：MySQL 单表数据量大于 2000 万行，性能会明显下降。事实上，这个传闻据说最早起源于百度。具体情况大概是这样的，当年的 DBA 测试 MySQL性能时发现，当单表的量在 2000 万行量级的时候，SQL 操作的性能急剧下降，因此，结论由此而来。然后又据说百度的工程师流动到业界的其它公司，也带去了这个信息，所以，就在业界流传开这么一个说法。

再后来，阿里巴巴《Java 开发手册》提出单表行数超过 500 万行或者单表容量超过 2GB，才推荐进行分库分表。对此，有阿里的黄金铁律支撑，所以，很多人设计大数据存储时，多会以此为标准，进行分表操作。

事实上，这个数值和实际记录的条数无关，而与 MySQL 的配置以及机器的硬件有关。因为，MySQL 为了提高性能，会将表的索引装载到内存中。InnoDB buffer size 足够的情况下，其能完成全加载进内存，查询不会有问题。但是，当单表数据库到达某个量级的上限时，导致内存无法存储其索引，使得之后的 SQL 查询会产生磁盘 IO，从而导致性能下降。当然，这个还有具体的表结构的设计有关，最终导致的问题都是内存限制。这里，增加硬件配置，可能会带来立竿见影的性能提升。

## MySQL单表数据量过多怎么优化呢？

### **1.数据库设计和表创建时就要考虑性能**

设计表时要注意：

表字段避免null值出现，null值很难查询优化且占用额外的索引空间，推荐默认数字0代替null。

尽量使用INT而非BIGINT，如果非负则加上UNSIGNED（这样数值容量会扩大一倍），当然能使用TINYINT、SMALLINT、MEDIUM_INT更好。

使用枚举或整数代替字符串类型

尽量使用TIMESTAMP而非DATETIME

单表不要有太多字段

用整型来存IP

### **2.sql的编写需要注意优化**

可以通过开启慢查询日志来找出较慢的SQL

使用limit对查询结果的记录进行限定

避免select *，将需要查找的字段列出来

使用连接（join）来代替子查询

sql语句尽可能简单：一条sql只能在一个cpu运算；大语句拆小语句，减少锁时间；一条大sql可以堵死整个库

OR改写成IN：OR的效率是n级别，IN的效率是log(n)级别，in的个数建议控制在200以内

少用JOIN

尽量避免在WHERE子句中使用!=或<>操作符，否则将引擎放弃使用索引而进行全表扫描

列表数据不要拿全表，要使用LIMIT来分页，每页数量也不要太大

### **3.分库**

把一个数据库分成多个.

### **4.分表**

分表分为垂直拆分和水平拆分

 





<https://www.toutiao.com/a6721868301678412296/?tt_from=android_share&utm_campaign=client_share×tamp=1565137497&app=news_article&utm_medium=toutiao_android&req_id=20190807082456010152042197728CC77&group_id=6721868301678412296>